<!doctype html>
<html lang="en">
<head>
  <title>Home Energy</title>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <meta name="apple-mobile-web-app-capable" content="yes" />

  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/dygraph/2.1.0/dygraph.min.css" />
  <link rel="stylesheet" href="main.css" />

  <script src="https://cdnjs.cloudflare.com/ajax/libs/dygraph/2.1.0/dygraph.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.3/Chart.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jstat@1.7.1/dist/jstat.min.js"></script>
</head>
<body>
  <nav class="navbar navbar-dark bg-dark">
    <a class="navbar-brand" href="#">⚡️ Home Energy Monitor</a>
    <div class="spinner-grow text-light" id="loading-indicator" role="status" style="display:none;">
      <span class="sr-only">Loading...</span>
    </div>
    <form class="form-inline">
      <button id="btnResetZoom" class="btn btn-outline-secondary btn-sm" type="button">Reset Zoom</button>
      <button class="btn btn-outline-secondary" type="button" id="btnYesterday">Yesterday</button>
      &nbsp;
      <button class="btn btn-outline-success" type="button" id="btnToday">Today</button>
    </form>
  </nav>

  <br />

  <div class="container-fluid">
    <div class="card">
      <div class="card-header d-flex justify-content-between">
        <span>Readings <small id="usage-kwh">? kWh</small></span>
        <span>Last Reading <small id="last-reading">?</small></span>
      </div>
      <div class="card-body scroll-container">
        <div id="graphdiv" style="min-width: 1500px; height: 300px;"></div>
      </div>
    </div>
  </div>

  <br />

  <div class="container-fluid">
    <div class="row">
      <div class="col-md-6">
        <div class="card">
          <div class="card-header">Last 24 hours</div>
          <div class="card-body text-center">
            <div class="circle big">
              <p>Current<br /><span id="stats-current">? W</span></p>
            </div>
            <div class="circle">
              <p>Standby<br /><span id="stats-standby">? W</span></p>
            </div>
            <div class="circle">
              <p>Peak<br /><span id="stats-max">? W</span></p>
            </div>
            <div class="circle">
              <p>Today<br /><span id="stats-kwh">? kWh</span></p>
            </div>
          </div>
        </div>

        <div class="card mt-3">
          <div class="card-header">Standby-loss today</div>
          <div class="card-body text-center">
            <canvas id="chart-standby" height="100px"></canvas>
          </div>
        </div>
      </div>

      <div class="col-md-6">
        <div class="card">
          <div class="card-header">Last 30 days</div>
          <div class="card-body">
            <canvas id="canvas" height="300px"></canvas>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="main.js"></script>
  <script>
    (async function () {
      toggleLoadingIndicator(true);
      await Promise.all([initChart(), initUsageChart()]);
      toggleLoadingIndicator(false);
    })();
  </script>
</body>
</html>
